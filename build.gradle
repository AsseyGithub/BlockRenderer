import java.time.Instant

buildscript {
	repositories {
		maven { url = 'https://maven.fabricmc.net/' }
		jcenter()
		mavenCentral()
	}
	dependencies {
		classpath group: 'fabric-loom', name: 'fabric-loom.gradle.plugin', version: '0.2.+', changing: true
	}
}

apply plugin: 'fabric-loom'

group = "com.unascribed"
archivesBaseName = "BlockRenderer"
version = "20w18a-1.0.0"

sourceCompatibility = targetCompatibility = compileJava.sourceCompatibility = compileJava.targetCompatibility = JavaVersion.VERSION_1_8

dependencies {
	// https://modmuss50.me/fabric.html
	minecraft 'com.mojang:minecraft:20w18a'
	mappings 'net.fabricmc:yarn:20w18a+build.9:v2'
	modImplementation 'net.fabricmc:fabric-loader:0.8.2+build.194'

	//Fabric api
	modImplementation "net.fabricmc.fabric-api:fabric-api:0.10.1+build.336-1.16"

	// Javax Annotations
	modImplementation 'com.google.code.findbugs:jsr305:3+'
}

processResources {
	inputs.property "version", project.version

	from(sourceSets.main.resources.srcDirs) {
		include "fabric.mod.json"
		expand "version": project.version
	}

	from(sourceSets.main.resources.srcDirs) {
		exclude "fabric.mod.json"
	}
}

jar {
	manifest {
		attributes([
				'Specification-Title'     : rootProject.name,
				'Specification-Vendor'    : project.group,
				'Specification-Version'   : '1',
				'Implementation-Title'    : rootProject.name,
				'Implementation-Version'  : project.version,
				'Implementation-Vendor'   : project.group,
				'Implementation-Timestamp': Instant.now()
		])
	}
}

task sourcesJar(type: Jar, dependsOn: classes) {
	classifier = 'sources'
	from sourceSets.main.allSource
}

artifacts {
	archives sourcesJar
}
